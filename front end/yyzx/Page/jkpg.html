<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
    <title>上实颐养中心</title>
    <link href="../About/css/bootstrap.min.css" type="text/css" rel="stylesheet">
    <link href="../About/css/myCss.css" type="text/css" rel="stylesheet">
    <link href="../About/css/main.css" type="text/css" rel="stylesheet">
    <link href="../About/css/base.css" type="text/css" rel="stylesheet">
    <!--按钮样式表-->
    <link href="../About/css/btn.css" type="text/css" rel="stylesheet">
    <link href="../About/css/css.css" type="text/css" rel="stylesheet">
    <link href="../About/css/index.css" type="text/css" rel="stylesheet">
    <link href="../About/css/search.css" type="text/css" rel="stylesheet">

    <script src="../About/js/jquery.min.js"></script>
    <script src="../About/js/easing.js"></script>
    <script src="../About/js/bootstrap.min.js"></script>
    <script src="../About/js/jQuery.rTabs.js"></script>
    <script src="../node_modules/axios/dist/axios.js"></script>
    <script src="../node_modules/vue/dist/vue.global.js"></script>
    <!-- 日历 -->
    <script src="../About/codebase/dhtmlxscheduler.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" href="../About/codebase/dhtmlxscheduler.css" type="text/css" charset="utf-8">
    <script src="../About/codebase/locale/locale_cn.js" type="text/javascript" charset="utf-8"></script>
    <!-- 支持模糊搜索的 下拉框 -->
    <link rel="stylesheet" type="text/css" href="../About/css/bootstrap-select.min.css"/>
    <script type="text/javascript" src="../About/js/bootstrap-select.min.js"></script>
    <style>
        .pad {
            padding:16px;
            font-size: 14px;
        }
        .pad-max {
            padding:16px;
            font-size: 18px;
        }
        .bed{
            width:30px;
        }
        .beds{
            margin-top: 20%;
        }
        .bed-roomid{
            margin-top: 15%;
        }

        .width_tjtjxx_l{
            text-align: right;
            width: 80px;
        }
        .cw_img{
            width:25px;
            float: left;
        }
        .cw_img img{
            width:100%;
            height: 100%;
        }
        .cw_num{
            padding-left: 5px;
        }
        .cwsyt_thead{
            background-color: #0168b7;
        }
        .cwsyt_tbody{
            height: 120px;
            text-align: center;
        }
        .room_id{
            color:white;
            width: 100px;
            height: 20px;
            text-align: center;
        }
        .cw_img_lg{
            width:50px;
        }
        .cw_img_lg img{
            width:100%;
            height: 100%;
            margin-left: 55%;
        }
        .ml15{
            margin-left: 15px;
        }
        label{
            margin-left: 15px;
        }
        .list_style{
            list-style: disc outside none;
        }
        #jcsjwh_ck input{
            background-color: white;
        }
    </style>
</head>
<body>
<!--健康评估-->
<div class="jkpg page" id="app">
    <div class="col-md-12 pd20 RightContentBody fmt10">
        <div class="col-md-12 pd0 fmt5">
            <div class="input-group inputWidth_search" style="float: left;">
                <input type="text" class="form-control" placeholder="客户姓名" v-model="queryHealthAss">
                <span class="input-group-addon" v-on:click="query">快速查询</span>
            </div>
            <div style="float: left;padding-left: 15px;">
                <button class="btn btn-primary" data-toggle="modal" data-target=".myModal1"
                        v-on:click="newHealthAss"><span class="glyphicon glyphicon-plus">
                        </span>&nbsp;添加</button>
            </div>
            <div class="modal fade myModal1">
                <div class="modal-dialog">
                    <div class="modal-content" style="width:100%;">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <span class="glyphicon glyphicon-pencil"></span>&nbsp;【健康评估】
                        </div>
                        <div class="modal-body clearfix" style="height: auto;">
                            <div class="col-md-12 pd0">
                                <div class="col-md-1 pd0 mt10"></div>
                                <div class="col-md-10 pd0">
                                    <div class="col-md-12 pd0">
                                        <div class="input-group inputWidth">
                                            <span class="input-group-addon titleWidth">&nbsp;&nbsp;姓名：</span>
                                            <input type="text" class="form-control" placeholder="请输入【客户姓名】信息"
                                                   v-model="name">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 pd0"></div>
                            </div>
                            <div class="col-md-12 pd0 mt10">
                                <div class="col-md-1 pd0"></div>
                                <div class="col-md-10 pd0">
                                    <div class="col-md-12 pd0">
                                        <div class="input-group inputWidth">
                                            <span class="input-group-addon titleWidth">&nbsp;&nbsp;年龄：</span>
                                            <input type="text" class="form-control" placeholder="请输入【年龄】信息"
                                                   v-model="age">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 pd0"></div>
                            </div>
                            <div class="col-md-12 pd0 mt10">
                                <div class="col-md-1 pd0"></div>
                                <div class="col-md-10 pd0">
                                    <div class="col-md-12 pd0">
                                        <div class="input-group inputWidth">
                                            <span class="input-group-addon titleWidth">&nbsp;&nbsp;性别：</span>
                                            <select class="form-control" v-model="gender">
                                                <option value="男">男</option>
                                                <option value="女">女</option>

                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 pd0"></div>
                            </div>
                            <div class="col-md-12 pd0 mt10">
                                <div class="col-md-1 pd0"></div>
                                <div class="col-md-10 pd0">
                                    <div class="col-md-12 pd0">
                                        <div class="input-group inputWidth">
                                            <span class="input-group-addon titleWidth">&nbsp;&nbsp;身份证号：</span>
                                            <input type="text" class="form-control" placeholder="请输入【身份证号】信息"
                                                   v-model="idCard">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 pd0"></div>
                            </div>
                            <div class="col-md-12 pd0 mt10">
                                <div class="col-md-1 pd0"></div>
                                <div class="col-md-10 pd0">
                                    <div class="col-md-12 pd0">
                                        <div class="input-group inputWidth">
                                            <span class="input-group-addon titleWidth">&nbsp;&nbsp;联系电话：</span>
                                            <input type="text" class="form-control" placeholder="请输入【联系电话】信息"
                                                   v-model="contactInfo">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 pd0"></div>
                            </div>
                            <div class="col-md-12 pd0 mt10">
                                <div class="col-md-1 pd0"></div>
                                <div class="col-md-10 pd0">
                                    <div class="col-md-12 pd0">
                                        <div class="input-group inputWidth">
                                            <span class="input-group-addon titleWidth">&nbsp;&nbsp;评估结果：</span>
                                            <select class="form-control" v-model="livingStatus">
                                                <option value="健康">健康</option>
                                                <option value="正常">正常</option>
                                                <option value="生病">生病</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 pd0"></div>
                            </div>
                            <div class="col-md-12 pd0 mt10">
                                <div class="col-md-1 pd0"></div>
                                <div class="col-md-10 pd0">
                                    <div class="col-md-12 pd0">
                                        <div class="input-group inputWidth">
                                            <span class="input-group-addon titleWidth">&nbsp;&nbsp;最近评估时间：</span>
                                            <input type="date" class="form-control" v-model="lastAssessmentDate">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 pd0"></div>
                            </div>
                        <div class="modal-footer mt20">
                            <button type="button" class="btn btn-primary" data-dismiss="modal"
                                    v-on:click="addOrUpdateHealthAss">
                                确定
                            </button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">
                                取消
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>











            <div class="modal fade myModal2">
                <div class="modal-dialog">
                    <div class="modal-content" style="width:100%;">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <span class="glyphicon glyphicon-pencil"></span>&nbsp;【健康评估结果】
                        </div>
                        <div class="modal-body clearfix" style="height: auto;">
                            <div class="col-md-12 pd0">
                                <div class="col-md-1 pd0 mt10"></div>
                                <div class="col-md-10 pd0">
                                    <div class="col-md-12 pd0">
                                        <div class="input-group inputWidth">
                                            <span class="input-group-addon titleWidth">&nbsp;&nbsp;评估结果：</span>
                                            <input type="text" class="form-control" placeholder="请输入评估信息"
                                                   v-model="assessmentResult">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-1 pd0"></div>
                            </div>

                            <div class="modal-footer mt20">
                                <button type="button" class="btn btn-primary" data-dismiss="modal"
                                        v-on:click="addOrUpdateHealthAss">
                                    确定
                                </button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">
                                    取消
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



















        <div class="col-md-12 pd0 fmt10">
            <hr class="commonHRCss"/>
        </div>
        <div class="col-md-12 pd0">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>姓名</th>
                    <th>性别</th>
                    <th>年龄</th>
                    <th>身份证号</th>
                    <th>联系方式</th>
                    <th>评估结果</th>
                    <th>最近评估时间</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="(item,index) in HealthAssList" :key="index">
                    <td>{{index+1}}</td>
                    <td>{{item.name}}</td>
                    <td>{{item.gender}}</td>
                    <td>{{item.age}}</td>
                    <td>{{item.idCard}}</td>
                    <td>{{item.contactInfo}}</td>
                    <td>{{item.livingStatus}}</td>
                    <td>{{item.lastAssessmentDate}}</td>
                    <td></td>
                    <td>
                        <button class="btn btn-primary" data-toggle="modal" data-target=".myModal1"
                                v-on:click="modify(item.id,index)">修改</button>
                        <button class="btn btn-danger" v-on:click="remove(item.id)">删除</button>
                        <button class="btn btn-primary" data-toggle="modal" data-target=".myModal2"
                                v-on:click="modify(item.id,index)">查看健康评估报告</button>
                    </td>

                </tr>
                </tbody>
                <tr>
                    <td colspan="13">总记录数：{{total}}</td>
                </tr>
            </table>
        </div>
        <div class="col-md-12 pd0">
            <div class="col-md-12 text-right pd0 fmt20">
                <nav aria-label="Page navigation">
                    <ul class="pagination">
                        <li @click="previousPage">
                            <a href="#" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <li v-for="(item, index) in pages" :key="index"><a v-on:click="listHealthAss(index+1, size)">{{index+1}}</a></li>

                        <li @click="nextPage">
                            <a href="#" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>
</div>
</body>
<script >
    const app = Vue.createApp({
        data: function () {
            return {
                queryHealthAss:[],
                currentPage: 1,
                size: 10,

                HealthAssList: [],
                pages:0,
                total:0,

                id: null,
                name: '',
                age: null,
                gender: null,
                idCard: null,
                contactInfo:null,
                livingStatus:null,
                lastAssessmentDate:null,
                assessmentResult:null,
                createdAt:null,
                updatedAt:null
            }
        },
        methods:{
            query:function(){
                console.log("--------------------------",this.queryHealthAss);
                if(this.queryHealthAss){
                    axios.get("http://localhost:8080/queryHealthAss",{params:{name: this.queryHealthAss}})
                        .then(res => {
                            if(res.data&&res.data.length!==0)
                            {
                                this.HealthAssList = res.data;
                                console.log("**********************", this.HealthAssList);
                            }
                            else {this.listHealthAss(this.currentPage,this.size)}

                        })
                        .catch(err => {
                            console.error(err);
                        })
                }else{}


            },
            listHealthAss: function (page, size) {
                this.currentPage = page;
                axios.get("http://localhost:8080/listHealthAss", { params: { page, size } })
                    .then(res => {
                        console.log(res)
                        this.HealthAssList = res.data.list
                        this.pages = res.data.pages
                        this.total = res.data.total
                    })
                    .catch(err => {
                        console.error(err);
                    })
            },
            modify(id,index) {
                var h=this.HealthAssList[index];
                this.id = h.id;
                this.age=h.age;
                this.name=h.name;
                this.gender=h.gender;
                this.idCard=h.idCard;
                this.contactInfo=h.contactInfo;
                this.livingStatus=h.livingStatus;
                this.lastAssessmentDate=h.lastAssessmentDate;
                this.assessmentResult=h.assessmentResult;
                this.createdAt=h.createdAt;
                this.updatedAt=h.updatedAt;
            },

            nextPage:function(){
                if(this.currentPage<this.pages){
                    this.currentPage+=1,
                        this.listHealthAss(this.currentPage, this.size)
                }
            },
            previousPage:function(){
                if(this.currentPage>1){
                    this.currentPage-=1
                    this.listHealthAss(this.currentPage, this.size)
                }
            },
            addOrUpdateHealthAss: function (id) {
                data = {
                    id: this.id,
                    name: this.name,
                    age: this.age,
                    gender: this.gender,
                    idCard: this.idCard,
                    contactInfo: this.contactInfo,
                    livingStatus: this.livingStatus,
                    lastAssessmentDate: this.lastAssessmentDate,
                    assessmentResult: this.assessmentResult,
                    updatedAt: null
                }

                axios.post("http://localhost:8080/HealthAssessment_saveOrUpdate", data)
                    .then(res => {
                        console.log(res)
                        if (res.data == 'success') {
                            this.listHealthAss(this.currentPage, this.size)
                        }
                    })
                    .catch(err => {
                        console.error(err);
                        if (err.response) {
                            // 服务器端返回的响应
                            console.error(err.response.data);
                            console.error(err.response.status);
                            console.error(err.response.headers);
                        }
                    })

            },
            newHealthAss() {
                this.id = null;
            },
            remove: function (id) {
                axios.delete("http://localhost:8080/removeHealthAss", { params: { id } })
                    .then(res => {
                        if (res.data == 'success') {
                            this.listHealthAss(this.currentPage, this.size);
                        }
                    })
                    .catch(err => {
                        console.error(err);
                    })
            },

        },
        created() {
            this.listHealthAss(1, 10)
        },

    }).mount("#app")

</script>
</html>